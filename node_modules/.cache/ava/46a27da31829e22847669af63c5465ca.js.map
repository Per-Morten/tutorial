{"version":3,"sources":["model.test.js"],"names":["db","require","mongoose","PersonModel","person","firstname","lastname","address","postcode","cb","before","t","then","end","catch","err","fail","after","connection","dropDatabase","close","beforeEach","remove","serial","plan","p","create","Object","assign","pass","p2","find","_id","exec"],"mappings":";;AAAA;;;;;;AAEA,MAAMA,KAAKC,QAAQ,aAAR,CAAX;AACA,MAAMC,WAAWD,QAAQ,UAAR,CAAjB;AACA,MAAME,cAAcF,QAAQ,qBAAR,CAApB;;AAEA,MAAMG,SAAS;AACXC,eAAW,QADA;AAEXC,cAAU,QAFC;AAGXC,aAAS,qBAHE;AAIXC,cAAU;AAJC,CAAf;;AAOA,cAAKC,EAAL,CAAQC,MAAR,CAAgBC,CAAD,IAAO;AAClBX,OAAG,mBAAH,EACKY,IADL,CACU,MAAMD,EAAEE,GAAF,EADhB,EAEKC,KAFL,CAEWC,OAAOJ,EAAEK,IAAF,CAAOD,GAAP,CAFlB;AAGH,CAJD;AAKA,cAAKN,EAAL,CAAQQ,KAAR,CAAeN,CAAD,IAAO;AACjBT,aAASgB,UAAT,CAAoBlB,EAApB,CAAuBmB,YAAvB,CAAoC,MAAM;AACtCjB,iBAASgB,UAAT,CAAoBE,KAApB;AACAT,UAAEE,GAAF;AACH,KAHD;AAIH,CALD;;AAQA,cAAKJ,EAAL,CAAQY,UAAR,CAAoBV,CAAD,IAAO;AACtBR,gBAAYmB,MAAZ,CAAmB,EAAnB,EAAuB,MAAMX,EAAEE,GAAF,EAA7B;AACH,CAFD;;AAIA,cAAKU,MAAL,CAAY,mBAAZ,EAAiC,MAAOZ,CAAP,IAAa;AAC1CA,MAAEa,IAAF,CAAO,CAAP;AACA,UAAMC,IAAI,MAAMtB,YAAYuB,MAAZ,CAAmBC,OAAOC,MAAP,CAAc,EAAd,EAAkBxB,MAAlB,CAAnB,CAAhB;AACA,QAAGqB,CAAH,EAAM;AACFd,UAAEkB,IAAF;AACH,KAFD,MAEO;AACHlB,UAAEK,IAAF,CAAO,2BAAP;AACH;;AAED,UAAMc,KAAK,MAAM3B,YAAY4B,IAAZ,CAAiB,EAACC,KAAKP,EAAEO,GAAR,EAAjB,EAA+BC,IAA/B,EAAjB;AACA,QAAG,CAACH,EAAJ,EAAQ;AACJnB,UAAEkB,IAAF;AACH,KAFD,MAEO;AACHlB,UAAEK,IAAF,CAAO,mCAAP;AACH;AAIJ,CAlBD","file":"model.test.js","sourcesContent":["import test from 'ava';\n\nconst db = require('../database');\nconst mongoose = require('mongoose');\nconst PersonModel = require('../../models/Person');\n\nconst person = {\n    firstname: 'Bjarte',\n    lastname: 'Larsen',\n    address: 'Prost bloms gate 38',\n    postcode: 2819,\n};\n\ntest.cb.before((t) => {\n    db('person-model-test')\n        .then(() => t.end())\n        .catch(err => t.fail(err));\n});\ntest.cb.after((t) => {\n    mongoose.connection.db.dropDatabase(() => {\n        mongoose.connection.close();\n        t.end();\n    })\n});\n\n\ntest.cb.beforeEach((t) => {\n    PersonModel.remove({}, () => t.end());\n});\n\ntest.serial('Create a new user', async (t) => {\n    t.plan(2);\n    const p = await PersonModel.create(Object.assign({}, person));\n    if(p) {\n        t.pass();\n    } else {\n        t.fail('Could not create the user');\n    }\n\n    const p2 = await PersonModel.find({_id: p._id}).exec();\n    if(!p2) {\n        t.pass();\n    } else {\n        t.fail('Could not find the created person');\n    }\n\n\n\n});"]}